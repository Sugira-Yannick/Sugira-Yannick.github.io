
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Commandes Importantes</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --bg: #ffffff;
      --fg: #1e1e1e;
      --accent: #3498db;
      --code-bg: #f5f5f5;
      --note-bg: #e7f5fe;
      --warn-bg: #fff3cd;
    }
    [data-theme="dark"] {
      --bg: #1e1e1e;
      --fg: #ffffff;
      --accent: #2980b9;
      --code-bg: #2b2b2b;
      --note-bg: #2c3e50;
      --warn-bg: #664d03;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex;
    }
    nav {
      width: 250px;
      background: var(--accent);
      color: white;
      padding: 20px;
      height: 100vh;
      position: sticky;
      top: 0;
      overflow-y: auto;
    }
    nav h2 {
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    nav a {
      display: block;
      color: white;
      text-decoration: none;
      margin: 5px 0;
    }
    nav a:hover {
      text-decoration: underline;
    }
    .content {
      flex: 1;
      padding: 20px;
      max-width: 1000px;
    }
    h1, h2 {
      color: var(--accent);
    }
    pre {
      background: var(--code-bg);
      padding: 15px;
      border-left: 4px solid var(--accent);
      position: relative;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    code {
      font-family: Consolas, monospace;
      color: #c7254e;
    }
    .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #ccc;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
    }
    .note, .warning {
      padding: 10px;
      margin: 15px 0;
      border-left: 4px solid var(--accent);
    }
    .note { background: var(--note-bg); }
    .warning { background: var(--warn-bg); }
    .theme-toggle {
      position: absolute;
      top: 10px;
      right: 20px;
      cursor: pointer;
      font-size: 1.2em;
    }
    @media (max-width: 768px) {
      nav { display: none; }
      body { flex-direction: column; }
    }
  </style>
</head>
<body>
  <nav>
    <h2>Navigation</h2>
    <a href="#linux">Linux</a>
    <a href="#windows">Windows</a>
    <a href="#cisco">Cisco</a>
    <a href="#powershell">PowerShell</a>
    <a href="#reseau">R√©seau</a>
    <a href="#pfsense">pfSense</a>
    <a href="#administration">Administration</a>
  </nav>

  <div class="content">
    <span class="theme-toggle" onclick="toggleTheme()">üåì</span>
    <h1>Commandes Importantes</h1>

    <!-- Le contenu complet sera inject√© ici dynamiquement par la suite -->
    <!-- Pour simplifier l'exemple, on commence par g√©n√©rer la structure du fichier -->
    

    <h2>Routage sous Linux</h2>
    <pre><code># Ajouter une route
ip route add (IP address de destination)/(mask) via (IP local capable d'aller vers le r√©seau de destination)

# Ajouter une route par d√©faut
ip route add default via &lt;address-passerelle&gt;

# Rendre une route permanente (Debian/Ubuntu)
echo "192.168.10.0/24 via 192.168.60.5 dev eth0" | sudo tee -a /etc/network/interfaces

# V√©rifier la table de routage
ip route show

# Ajouter une adresse IP permanente
ip address add 192.168.1.2/24 dev eth0 sur l'interface concern√© dans /etc/network/interfaces
up ip address add 192.168.1.2/24 dev eth0 sur l'interface concern√©</code></pre>

    <h2>Routage sous Windows (Permanent)</h2>
    <pre><code>ip add -p (IP addres de destination) MASK (ex:255.255.255.0) (IP local capable d'aller vers le r√©seau de destination)</code></pre>

    <h2>Configuration d'interface sous Linux</h2>
    <pre><code># Lister les interfaces
ip link show, ip a

# Activer une interface
ip link set &lt;interface&gt; up

# Configurer une adresse IP
ip address add &lt;IP&gt;/&lt;masque&gt; dev &lt;interface&gt;

# V√©rifier l'adresse IP
ip address show &lt;interface&gt;</code></pre>

    <h2>NAT sous Windows</h2>
    <pre><code># Activer le routage IP
Set-NetIPInterface -InterfaceAlias "Ethernet" -Forwarding Enabled

# Configurer le NAT pour un r√©seau
New-NetNat -Name "SwitchAccess" -InternalIPInterfaceAddressPrefix "192.168.10.0/24"
	    

# Capture du traffic sur une Interface Windows
netsh trace start capture=yes Ethernet IPv4.Address=IP Adresse
	    

# V√©rifier le NAT
Get-NetNat
get-NetNatStaticMappingetFirewallRule -DisplayName "Allow_Linux_Subnet" -RemoteAddress 192.168.60.4 -Action Allow
Get-NetNatTransitionConfiguration

# Proxy SSH via Windows
ssh -J user@&lt;IP_Windows&gt; user@&lt;IP_Machine_Adminstr√©e&gt;

# Tester l'acc√®s SSH
Test-NetConnection 10.10.2.2 -Port 22</code></pre>

    <h2>NAT sous Linux</h2>
    <pre><code># D√©sactiver NAT temporairement
iptables -t nat -F POSTROUTING

# Activer NAT
iptables -t nat -A POSTROUTING -s &lt;Network+Mask&gt; -o &lt;Interface&gt; -j MASQUERADE

# Activer le forwarding IP
sysctl -w net.ipv4.ip_forward=1
# Permanent: Edit /etc/sysctl.conf and set net.ipv4.ip_forward=1.

# V√©rifier le NAT
sudo iptables -t nat -L POSTROUTING -v -n --line-numbers
iptables -t nat -L -n -v

# V√©rifier le port forwarding
cat /proc/sys/net/ipv4/ip_forward

# Afficher les paquets NAT en temps r√©el
watch -n 1 'sudo iptables -t nat -L POSTROUTING -v -n'</code></pre>

    <div class="note">
        <p><strong>Alternative (for Static IPs):</strong> Use SNAT</p>
        <pre><code>iptables -t nat -A POSTROUTING -s 30.30.30.0/30 -o pnet0 -j SNAT --to-source [PUBLIC_IP]</code></pre>
    </div>

    <h2>NAT pour protocoles sp√©cifiques</h2>
    <pre><code># Autoriser les paquets RIP (destination)
iptables -t nat -A POSTROUTING -p udp --dport 520 -j ACCEPT

# Autoriser les paquets RIP (source)
iptables -t nat -A POSTROUTING -p udp --sport 520 -j ACCEPT

# Autoriser tous les paquets
iptables -A FORWARD -i pnet0 -j ACCEPT
iptables -A FORWARD -o pnet0 -j ACCEPT</code></pre>

    <div class="warning">
        <p><strong>Common Pitfalls:</strong></p>
        <ul>
            <li>Interface name typo: Ensure pnet0 exists (ip a or ifconfig)</li>
            <li>Missing kernel support: Verify NAT is supported (lsmod | grep iptable_nat)</li>
            <li>Firewall conflicts: Check if other rules block traffic (iptables -L)</li>
        </ul>
    </div>

    <h2>Traceroute</h2>
    <pre><code># Envoyer seulement 3 paquets par saut
traceroute 8.8.8.8 probe 3

# Trouver le PID du traceroute
show processes | include traceroute

# Terminer le processus
kill &lt;PID&gt;</code></pre>

    <h2>RIP Cisco</h2>
    <pre><code># Afficher les routes RIP
show ip route rip

# Afficher les voisins RIP
show ip rip neighbors

# D√©sactiver RIP sur toutes les interfaces sauf celles n√©cessaires
passive-interface default

# Activer RIP sur une interface sp√©cifique
int &lt;Interface&gt;
no passive-interface

# Debug RIP
debug ip rip

# Afficher la configuration RIP
show run | section router rip

# Effacer la table de routage
clear ip route *

# Afficher la base de donn√©es RIP
show ip rip database

# Modifier la m√©trique RIP
int &lt;Interface&gt;
ip rip metric 1

# D√©sactiver RIP sur une interface
int &lt;Interface&gt;
no ip rip send

# Forcer les broadcasts RIP v2
int &lt;Interface&gt;
ip rip v2-broadcast

# D√©sactiver le debug
undebug all</code></pre>

    <h2>Multicast Cisco</h2>
    <pre><code># Activer le multicast
configure terminal => ip multicast-routing

# Activer PIM
int &lt;Interface&gt;
ip pim sparse-mode

# Utiliser IGMPv2
ip igmp version 2

# Afficher la table multicast
show ip mroute

# Lister les groupes joints
show ip igmp groups

# Debug IGMP
debug ip igmp

# Lister les interfaces PIM-actives
show ip pim interface

# V√©rifier la RPF
show ip rpf 224.0.0.9

# Partager les r√©seaux locaux connect√©s
redistribute connected</code></pre>

    <h2>Commandes Cisco diverses</h2>
    <pre><code># Afficher les interfaces VLAN
show ip int bri | include vlan

# Afficher les d√©tails des VLANs
show vlan brief

# Afficher la table ARP
show arp

# Afficher les listes d'acc√®s
show access-lists

# V√©rifier la connectivit√© physique
show cdp neighbors

# Filtrer la table ARP
show arp | inculde &lt;IP&gt;

# Afficher le switch root
show spanning-tree root

# Afficher une route sp√©cifique
show ip route 224.0.0.0/24

# Configurer un tunnel
int Tunnel0
tunnel source &lt;Interface&gt;
tunnel destination &lt;IP de l'autre √©quipement ou Tunnel sur l'autre&gt; 
keepalive
ip address &lt;IP&gt; &lt;MASK&gt;
no ip split-horizon
ip rip advertise &lt;Network&gt;
no shut</code></pre>

    <h2>Tcpdump - Capture de paquets</h2>
    <pre><code># Capturer les paquets UDP RIP
tcpdump -i any or &lt;Interface&gt; port 250(ou autres selon la situation) -vv -n

# Capturer les paquets avec une adresse IP sp√©cifique
tcpdump -i eth0 -nn 'host 224.0.0.9'

# V√©rifier le trafic NAT
sudo tcpdump -i &lt;interface_host_local&gt; host NAT &lt;IP_WINDOWS&gt;</code></pre>

    <h2>Table de routage</h2>
    <pre><code># Afficher la table de routage (Linux et Windows)
netstat -rn</code></pre>

    <h2>Analyse des logs sous Linux</h2>
    <pre><code># Afficher les logs RIP
grep RIP /var/log/system.log

# Afficher les logs RIP en temps r√©el
tail -f /var/log/system.log | grep ripd

# V√©rifier le service RIP
ps aux | grep ripd</code></pre>

    <h2>pfSense</h2>
    <pre><code># Gestion du firewall
pftcl -d && pfctl -e

# V√©rifier les r√®gles firewall pour le port RIP
pfctl -sr | grep 520

# Red√©marrer le service RIP
/etc/rc.d/ripd restart

# Gestion de l'historique
history
fc -l
history | grep rip
cat ~/.history

# Configurer l'historique persistant
echo 'export HISTFILE=~/.persistent_history' >> ~/.shrc
echo 'export HISTSIZE=10000' >> ~/.shrc
touch ~/.persistent_history

# Raccourcis historiques
!!  # R√©p√®te la derni√®re commande
!ssh  # Rappelle la derni√®re commande commen√ßant par ssh

# Gestion des r√®gles pfSense
nano /etc/pf.conf
# Ajouter avant les r√®gles de blocage:
pass in quick proto udp from any to any port = 520  # Autoriser RIP

# Recharger les r√®gles
pfctl -f /etc/pf.conf</code></pre>

    <h2>Ping</h2>
    <pre><code># Ping depuis une IP source sp√©cifique
ping -S &lt;IP source&gt; -c 3 &lt;IP Destination&gt;</code></pre>


<!-- D√©but de la section Windows Server -->
<h2>Administration Windows Server avec PowerShell</h2>

<h3>1. Installation et configuration initiale</h3>
<pre><code># V√©rifier la version de Windows
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer

# Activer le r√¥le de serveur (ex: AD DS)
Install-WindowsFeature AD-Domain-Services -IncludeManagementTools

# Configurer un nouveau contr√¥leur de domaine
Install-ADDSForest -DomainName "corp.example.com" -DomainNetbiosName "CORP" -InstallDns

# Red√©marrer apr√®s installation
Restart-Computer -Force</code></pre>

<h3>2. Gestion des utilisateurs et groupes AD</h3>
<pre><code># Cr√©er un nouvel utilisateur
New-ADUser -Name "Jean Dupont" -GivenName "Jean" -Surname "Dupont" `
            -SamAccountName "jdupont" -UserPrincipalName "jdupont@corp.example.com" `
            -Path "OU=Utilisateurs,DC=corp,DC=example,DC=com" -AccountPassword (ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force) `
            -Enabled $true

# Modifier un utilisateur
Set-ADUser -Identity jdupont -Office "Paris" -Department "IT" -Title "Administrateur Syst√®me"

# Cr√©er un groupe et ajouter des membres
New-ADGroup -Name "Admins IT" -GroupScope Global -Path "OU=Groupes,DC=corp,DC=example,DC=com"
Add-ADGroupMember -Identity "Admins IT" -Members jdupont

# Lister tous les utilisateurs d'une OU
Get-ADUser -Filter * -SearchBase "OU=Utilisateurs,DC=corp,DC=example,DC=com" | Select Name,SamAccountName</code></pre>

<h3>3. Gestion des strat√©gies de groupe (GPO)</h3>
<pre><code># Cr√©er une nouvelle GPO
New-GPO -Name "Verrouillage Station" -Comment "Strat√©gie de s√©curit√© de base"

# Lier une GPO √† une OU
New-GPLink -Name "Verrouillage Station" -Target "OU=Utilisateurs,DC=corp,DC=example,DC=com"

# Modifier une GPO
Set-GPRegistryValue -Name "Verrouillage Station" -Key "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System" `
                    -ValueName "DisableTaskMgr" -Type DWord -Value 1

# Forcer la mise √† jour des GPO sur un client
Invoke-GPUpdate -Computer "CLIENT01" -Force</code></pre>

<h3>4. Gestion du stockage</h3>
<pre><code># Lister les disques disponibles
Get-Disk

# Initialiser un nouveau disque
Initialize-Disk -Number 1 -PartitionStyle GPT

# Cr√©er une partition
New-Partition -DiskNumber 1 -UseMaximumSize -DriveLetter D

# Formater le volume
Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel "Donn√©es" -Confirm:$false

# Configurer un quota de disque
New-FsrmQuota -Path "D:\Partage" -Size 5GB -Description "Limite 5GB par utilisateur"</code></pre>

<h3>5. Surveillance et maintenance</h3>
<pre><code># V√©rifier l'espace disque
Get-Volume | Select DriveLetter,FileSystemLabel,SizeRemaining,Size

# Analyser les √©v√©nements syst√®me
Get-EventLog -LogName System -Newest 50 | Where-Object {$_.EntryType -eq "Error"}

# Planifier une t√¢che
$action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-File D:\scripts\cleanup.ps1"
$trigger = New-ScheduledTaskTrigger -Daily -At 2am
Register-ScheduledTask -TaskName "Nettoyage nocturne" -Action $action -Trigger $trigger -User "SYSTEM"

# V√©rifier les services critiques
Get-Service | Where-Object {$_.Status -ne "Running" -and $_.StartType -eq "Automatic"}</code></pre>

<!-- D√©but de la section DHCP et DNS Windows Server -->
<h2>Administration DHCP et DNS sous Windows Server</h2>

<h3>1. Installation des r√¥les DHCP et DNS</h3>
<pre><code># Installer les r√¥les DHCP et DNS
Install-WindowsFeature DHCP,DNS -IncludeManagementTools

# Configurer le serveur DHCP apr√®s installation
Add-DhcpServerInDC -DnsName "dc1.corp.example.com" -IPAddress 192.168.1.1

# Red√©marrer si n√©cessaire
Restart-Computer -Force</code></pre>

<h3>2. Configuration DHCP de base</h3>
<pre><code># Cr√©er une √©tendue DHCP
Add-DhcpServerv4Scope -Name "R√©seau Principal" `
                      -StartRange 192.168.1.100 -EndRange 192.168.1.200 `
                      -SubnetMask 255.255.255.0 -State Active

# Configurer les options de l'√©tendue
Set-DhcpServerv4OptionValue -ScopeId 192.168.1.0 `
                           -DnsServer 192.168.1.1, 192.168.1.2 `
                           -Router 192.168.1.1 `
                           -DnsDomain "corp.example.com"

# Activer les adresses MAC r√©serv√©es
Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 `
                           -IPAddress 192.168.1.50 `
                           -ClientId "01-23-45-67-89-AB" `
                           -Description "Serveur d'impression"

# Configurer les plages d'exclusion
Add-DhcpServerv4ExclusionRange -ScopeId 192.168.1.0 `
                              -StartRange 192.168.1.1 `
                              -EndRange 192.168.1.15</code></pre>

<h3>3. Gestion avanc√©e DHCP</h3>
<pre><code># Afficher toutes les √©tendues DHCP
Get-DhcpServerv4Scope

# Afficher les baux actifs
Get-DhcpServerv4Lease -ScopeId 192.168.1.0

# Supprimer un bail sp√©cifique
Remove-DhcpServerv4Lease -IPAddress 192.168.1.105

# Sauvegarder la configuration DHCP
Backup-DhcpServer -Path "C:\DHCP_Backup\" -Force

# Restaurer la configuration DHCP
Restore-DhcpServer -Path "C:\DHCP_Backup\" -Force

# Migrer un serveur DHCP
Export-DhcpServer -File "C:\DHCP_Export.xml" -Leases
Import-DhcpServer -File "C:\DHCP_Export.xml" -Leases</code></pre>

<h3>4. Configuration DNS de base</h3>
<pre><code># Cr√©er une zone DNS principale
Add-DnsServerPrimaryZone -Name "corp.example.com" `
                        -ZoneFile "corp.example.com.dns" `
                        -DynamicUpdate Secure

# Cr√©er une zone DNS inverse
Add-DnsServerPrimaryZone -NetworkId "192.168.1.0/24" `
                        -ZoneFile "1.168.192.in-addr.arpa.dns"

# Ajouter un enregistrement A
Add-DnsServerResourceRecordA -Name "serveur1" `
                           -ZoneName "corp.example.com" `
                           -IPv4Address "192.168.1.10" `
                           -CreatePtr

# Ajouter un enregistrement CNAME
Add-DnsServerResourceRecordCName -Name "www" `
                               -HostNameAlias "serveur1.corp.example.com" `
                               -ZoneName "corp.example.com"

# Ajouter un enregistrement MX
Add-DnsServerResourceRecordMX -Preference 10 `
                             -Name "@" `
                             -MailExchange "mail.corp.example.com" `
                             -ZoneName "corp.example.com"</code></pre>

<h3>5. Gestion avanc√©e DNS</h3>
<pre><code># Activer le nettoyage automatique
Set-DnsServerScavenging -ScavengingState $true `
                       -RefreshInterval 7.00:00:00 `
                       -NoRefreshInterval 7.00:00:00 `
                       -ApplyOnAllZones

# Forcer le nettoyage imm√©diat
Start-DnsServerScavenging -Force

# Configurer le transfert de zone
Set-DnsServerForwarder -IPAddress "8.8.8.8","8.8.4.4" -PassThru

# Configurer la r√©plication DNS entre contr√¥leurs de domaine
Set-DnsServerDirectoryPartition -Name "DomainDnsZones.corp.example.com" `
                               -ReplicationScope "Domain"

# Exporter la configuration DNS
Export-DnsServerZone -Name "corp.example.com" -FileName "C:\DNS_Backup\corp.example.com.dns"

# Importer une zone DNS
Import-DnsServerZone -Name "corp.example.com" -FileName "C:\DNS_Backup\corp.example.com.dns"</code></pre>

<h3>6. Surveillance et d√©pannage</h3>
<pre><code># V√©rifier l'√©tat du service DHCP
Get-Service -Name DHCPServer | Select-Object Name,Status,StartType

# Analyser les √©v√©nements DHCP
Get-EventLog -LogName "System" -Source "DHCPServer" -Newest 50

# Tester la r√©solution DNS
Resolve-DnsName -Name "serveur1.corp.example.com" -Type A

# Effectuer une requ√™te DNS d√©taill√©e
nslookup
> server 192.168.1.1
> set type=MX
> corp.example.com
> exit

# V√©rifier la r√©plication DNS
Repadmin /showrepl
Repadmin /syncall /AdeP

# Capturer le trafic DHCP/DNS
netsh trace start scenario=NetConnection capture=yes tracefile=C:\traces\network.etl
netsh trace stop</code></pre>

<h3>7. S√©curit√© DHCP et DNS</h3>
<pre><code># Configurer les options de s√©curit√© DHCP
Set-DhcpServerv4DnsSetting -DynamicUpdates "Always" `
                          -DeleteDnsRRonLeaseExpiry $true `
                          -UpdateDnsRRForOlderClients $true

# Activer DNSSEC pour une zone
Set-DnsServerZoneSigning -Name "corp.example.com" -Sign

# Configurer le filtrage DNS
Add-DnsServerQueryResolutionPolicy -Name "BlockMaliciousDomains" `
                                 -Action DENY `
                                 -FQDN "EQ,*.malicious.com" `
                                 -PassThru

# Restreindre les mises √† jour DNS dynamiques
Set-DnsServerPrimaryZone -Name "corp.example.com" `
                        -DynamicUpdate Secure</code></pre>

<h3>8. Scripts utiles</h3>
<pre><code># Script pour v√©rifier les baux DHCP expir√©s
$ExpiredLeases = Get-DhcpServerv4Lease -ScopeId 192.168.1.0 | Where-Object {$_.LeaseExpiryTime -lt (Get-Date)}
$ExpiredLeases | Export-Csv -Path "C:\Reports\ExpiredLeases.csv" -NoTypeInformation

# Script pour auditer les enregistrements DNS
$DNSRecords = Get-DnsServerResourceRecord -ZoneName "corp.example.com" -RRType "A"
$DNSRecords | Select-Object HostName,RecordType,Timestamp | Out-GridView

# Script pour migrer des plages DHCP
$OldScope = Get-DhcpServerv4Scope -ScopeId 192.168.0.0
Add-DhcpServerv4Scope -Name $OldScope.Name `
                     -StartRange 192.168.1.100 `
                     -EndRange 192.168.1.200 `
                     -SubnetMask $OldScope.SubnetMask
Get-DhcpServerv4OptionValue -ScopeId $OldScope.ScopeId | ForEach-Object {
    Set-DhcpServerv4OptionValue -ScopeId 192.168.1.0 -OptionId $_.OptionId -Value $_.Value
}</code></pre>

<!-- D√©but de la section Linux Server -->
<h2>Administration Linux Server</h2>

<h3>1. Gestion des utilisateurs et groupes</h3>
<pre><code># Cr√©er un nouvel utilisateur
sudo useradd -m -s /bin/bash jdupont
sudo passwd jdupont

# Modifier un utilisateur
sudo usermod -aG sudo jdupont  # Ajouter aux sudoers
sudo usermod -d /new/home/jdupont jdupont  # Changer le r√©pertoire home

# Cr√©er un groupe
sudo groupadd admins_it

# Ajouter un utilisateur √† un groupe
sudo usermod -aG admins_it jdupont

# Lister tous les utilisateurs
cut -d: -f1 /etc/passwd

# V√©rifier les sudoers
sudo grep -Po '^sudo.+:\K.*$' /etc/group</code></pre>

<h3>2. Gestion des permissions</h3>
<pre><code># Changer le propri√©taire d'un fichier
sudo chown jdupont:admins_it /chemin/du/fichier

# Changer les permissions (chmod en octal)
sudo chmod 750 /chemin/du/fichier  # rwx pour owner, r-x pour group, --- pour others

# Changer les permissions (chmod symbolique)
sudo chmod u=rwx,g=rx,o= /chemin/du/fichier

# D√©finir le bit SUID
sudo chmod u+s /chemin/du/fichier

# D√©finir le sticky bit sur un r√©pertoire
sudo chmod +t /chemin/du/repertoire</code></pre>

<h3>3. Gestion des paquets</h3>
<pre><code># Debian/Ubuntu
sudo apt update && sudo apt upgrade  # Mettre √† jour tous les paquets
sudo apt install apache2            # Installer un paquet
sudo apt remove apache2             # D√©sinstaller un paquet
sudo apt autoremove                 # Nettoyer les paquets inutiles

# RHEL/CentOS
sudo yum update                     # Mettre √† jour tous les paquets
sudo yum install httpd              # Installer un paquet
sudo yum remove httpd               # D√©sinstaller un paquet
sudo yum clean all                  # Nettoyer le cache</code></pre>

<h3>4. Gestion des services</h3>
<pre><code># Systemd (r√©cent)
sudo systemctl start apache2        # D√©marrer un service
sudo systemctl stop apache2         # Arr√™ter un service
sudo systemctl restart apache2      # Red√©marrer un service
sudo systemctl enable apache2       # Activer au d√©marrage
sudo systemctl status apache2       # V√©rifier l'√©tat

# SysVinit (ancien)
sudo service apache2 start          # D√©marrer un service
sudo service apache2 stop           # Arr√™ter un service
sudo service apache2 restart        # Red√©marrer un service
sudo update-rc.d apache2 defaults   # Activer au d√©marrage</code></pre>

<h3>5. Surveillance et maintenance</h3>
<pre><code># Espace disque
df -h                              # Afficher l'espace disque
du -sh /chemin                     # Taille d'un r√©pertoire

# M√©moire
free -m                            # Utilisation m√©moire
top                                # Moniteur d'activit√©
htop                               # Version am√©lior√©e de top

# Processus
ps aux                             # Lister tous les processus
pstree                             # Arbre des processus
kill -9 PID                        # Tuer un processus

# Journaux syst√®me
sudo journalctl -xe                # Afficher les logs systemd
sudo tail -f /var/log/syslog       # Suivre les logs en temps r√©el
sudo grep "error" /var/log/syslog  # Filtrer les erreurs</code></pre>

<h3>6. S√©curit√© et r√©seau</h3>
<pre><code># Pare-feu (UFW - Ubuntu)
sudo ufw enable                    # Activer le pare-feu
sudo ufw allow 22/tcp              # Autoriser le port SSH
sudo ufw deny 23/tcp               # Bloquer le port Telnet
sudo ufw status verbose            # V√©rifier les r√®gles

# Pare-feu (firewalld - RHEL/CentOS)
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --reload

# SSH
sudo ssh-keygen -t rsa -b 4096     # G√©n√©rer une paire de cl√©s
sudo nano /etc/ssh/sshd_config     # Configurer le serveur SSH
sudo systemctl restart sshd        # Red√©marrer SSH apr√®s modification

# Analyse de s√©curit√©
sudo lynis audit system            # Audit de s√©curit√©
sudo chkrootkit                   # V√©rifier les rootkits
sudo rkhunter --checkall          # Analyse compl√®te du syst√®me</code></pre>

<h3>7. Sauvegarde et restauration</h3>
<pre><code># Sauvegarde avec tar
sudo tar -czvf backup-$(date +%F).tar.gz /dossier/a/sauvegarder

# Sauvegarde incr√©mentielle avec rsync
sudo rsync -av --delete --link-dest=/previous/backup /source /destination/backup-$(date +%F)

# Sauvegarde MySQL
sudo mysqldump -u root -p --all-databases > full_backup.sql

# Sauvegarde PostgreSQL
sudo pg_dumpall -U postgres > full_backup.sql

# Planifier des sauvegardes avec cron
(crontab -l 2>/dev/null; echo "0 2 * * * /chemin/vers/script_backup.sh") | crontab -</code></pre>

<h3>8. Scripting avanc√©</h3>
<pre><code>#!/bin/bash
# Exemple de script de surveillance

# Variables
THRESHOLD=90
EMAIL="admin@example.com"

# V√©rification espace disque
DISK_USAGE=$(df / | awk '{print $5}' | tail -1 | cut -d'%' -f1)

if [ $DISK_USAGE -gt $THRESHOLD ]; then
    echo "Alerte : Espace disque critique sur $(hostname)" | mail -s "Alerte disque" $EMAIL
fi

# V√©rification m√©moire
MEM_FREE=$(free -m | awk '/Mem:/ {print $4}')
if [ $MEM_FREE -lt 100 ]; then
    echo "Alerte : M√©moire faible sur $(hostname)" | mail -s "Alerte m√©moire" $EMAIL
	
	<!-- D√©but de la section Commandes R√©seau -->
<h2>Commandes R√©seau PowerShell (Windows)</h2>

<h3>1. Configuration r√©seau de base</h3>
<pre><code># Lister toutes les interfaces r√©seau
Get-NetAdapter | Select Name, InterfaceDescription, Status

# Activer/D√©sactiver une interface
Enable-NetAdapter -Name "Ethernet" -Confirm:$false
Disable-NetAdapter -Name "Wi-Fi" -Confirm:$false

# Configurer une adresse IP statique
New-NetIPAddress -InterfaceAlias "Ethernet" -IPAddress 192.168.1.100 `
                 -PrefixLength 24 -DefaultGateway 192.168.1.1

# Configurer les serveurs DNS
Set-DnsClientServerAddress -InterfaceAlias "Ethernet" `
                          -ServerAddresses ("8.8.8.8", "8.8.4.4")</code></pre>

<h3>2. Diagnostic r√©seau</h3>
<pre><code># Test de connectivit√©
Test-NetConnection -ComputerName google.com -Port 80

# Traceroute am√©lior√©
Test-NetConnection -ComputerName google.com -TraceRoute

# Analyse des ports ouverts
Get-NetTCPConnection -State Listen | Sort-Object LocalPort | Format-Table

# V√©rifier la configuration IP d√©taill√©e
Get-NetIPConfiguration -Detailed

# Capturer des paquets (n√©cessite Npcap)
# Installer d'abord : choco install npcap
New-NetEventSession -Name "CaptureSession" -CaptureMode SaveToFile -LocalFilePath "C:\capture.etl"
Add-NetEventPacketCaptureProvider -SessionName "CaptureSession"
Start-NetEventSession -Name "CaptureSession"
Stop-NetEventSession -Name "CaptureSession"</code></pre>

<h3>3. Pare-feu avanc√©</h3>
<pre><code># Lister toutes les r√®gles
Get-NetFirewallRule | Where-Object {$_.Enabled -eq "True"} | Format-Table Name,DisplayName

# Cr√©er une nouvelle r√®gle
New-NetFirewallRule -Name "AllowWeb" -DisplayName "HTTP/HTTPS Access" `
                   -Direction Inbound -Protocol TCP -LocalPort 80,443 `
                   -Action Allow

# Bloquer une plage IP
New-NetFirewallRule -Name "BlockMalicious" -DisplayName "Block Malicious IPs" `
                   -Direction Inbound -RemoteAddress 192.168.100.0/24 `
                   -Action Block</code></pre>

<h3>4. Routage avanc√©</h3>
<pre><code># Afficher la table de routage
Get-NetRoute -AddressFamily IPv4 | Format-Table

# Ajouter une route statique
New-NetRoute -DestinationPrefix "10.0.0.0/24" -InterfaceAlias "Ethernet" `
             -NextHop 192.168.1.1 -RouteMetric 100

# Configurer le NAT (exige le r√¥le RRAS)
Install-WindowsFeature RemoteAccess -IncludeManagementTools
Install-RemoteAccess -VpnType RoutingOnly
Add-NetNatStaticMapping -NatName "CorpNAT" -Protocol TCP -ExternalIPAddress 203.0.113.25 `
                       -InternalIPAddress 192.168.1.50 -InternalPort 3389 -ExternalPort 3389</code></pre>

<h3>5. VPN et connectivit√© distante</h3>
<pre><code># Configurer un VPN (PowerShell 5.1+)
Add-VpnConnection -Name "CorporateVPN" -ServerAddress "vpn.corp.example.com" `
                 -TunnelType L2tp -L2tpPsk "SharedSecret123" -Force -RememberCredential

# Se connecter √† un VPN
rasdial "CorporateVPN" username password

# V√©rifier les connexions VPN
Get-VpnConnection</code></pre>

<h2>Commandes R√©seau Linux (CLI)</h2>

<h3>1. Configuration r√©seau de base</h3>
<pre><code># Lister les interfaces
ip link show
nmcli device status

# Activer/D√©sactiver une interface
sudo ip link set eth0 up
sudo ip link set eth0 down

# Configurer une adresse IP temporaire
sudo ip addr add 192.168.1.100/24 dev eth0

# Configurer une adresse IP permanente (Ubuntu/Debian)
sudo nano /etc/netplan/01-netcfg.yaml
# Exemple de configuration:
network:
  version: 2
  ethernets:
    eth0:
      addresses: [192.168.1.100/24]
      gateway4: 192.168.1.1
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
sudo netplan apply</code></pre>

<h3>2. Diagnostic r√©seau</h3>
<pre><code># Test de connectivit√©
ping -c 4 google.com
ping6 -c 4 ipv6.google.com

# Traceroute (installer avec: sudo apt install traceroute)
traceroute -n google.com

# V√©rifier les ports ouverts
ss -tulnp
netstat -tulnp  # Alternative

# Analyse des paquets
sudo tcpdump -i eth0 -n 'port 80'
sudo tshark -i eth0 -f "tcp port 22"  # Version avanc√©e (Wireshark CLI)

# Test de d√©bit (installer speedtest-cli)
speedtest-cli --bytes</code></pre>

<h3>3. Pare-feu avanc√© (iptables/nftables)</h3>
<pre><code># Lister les r√®gles iptables
sudo iptables -L -v -n --line-numbers

# Autoriser le trafic HTTP/HTTPS
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# Bloquer une IP
sudo iptables -A INPUT -s 192.168.100.23 -j DROP

# Sauvegarder les r√®gles (Debian/Ubuntu)
sudo iptables-save > /etc/iptables.rules

# nftables (nouvelle g√©n√©ration)
sudo nft add table inet filter
sudo nft add chain inet filter input { type filter hook input priority 0 \; }
sudo nft add rule inet filter input tcp dport 22 accept</code></pre>

<h3>4. Routage avanc√©</h3>
<pre><code># Afficher la table de routage
ip route show
route -n  # Alternative

# Ajouter une route statique
sudo ip route add 10.0.0.0/24 via 192.168.1.1 dev eth0

# Configurer le NAT
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
sudo sysctl -w net.ipv4.ip_forward=1

# Configurer le NAT permanent
echo "net.ipv4.ip_forward=1" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p</code></pre>

<h3>5. VPN et tunnels</h3>
<pre><code># OpenVPN (client)
sudo openvpn --config client.ovpn

# WireGuard (client)
sudo wg-quick up wg0

# Cr√©er un tunnel SSH
ssh -N -L 8080:localhost:80 user@remote-server
ssh -N -R 2222:localhost:22 user@remote-server  # Reverse tunnel

# Tunnel GRE (entre deux serveurs)
sudo ip tunnel add gre1 mode gre remote 203.0.113.2 local 198.51.100.1 ttl 255
sudo ip link set gre1 up
sudo ip addr add 10.0.0.1/30 dev gre1</code></pre>

<h3>6. Outils r√©seau avanc√©s</h3>
<pre><code># Analyse de bande passante (nload)
sudo nload eth0

# Monitorer les connexions (iftop)
sudo iftop -i eth0

# Scanner r√©seau (nmap)
sudo nmap -sS -p 1-1024 192.168.1.0/24

# Benchmark HTTP (httperf)
httperf --server example.com --port 80 --uri / --num-conn 100

# Test de r√©silience (mtr)
mtr -n --report google.com</code></pre>

<h3>7. Scripts r√©seau utiles</h3>
<pre><code>#!/bin/bash
# Script de surveillance r√©seau
INTERFACE="eth0"
MAX_UTIL=90

# V√©rifier l'utilisation de la bande passante
CURRENT_RX=$(ifconfig $INTERFACE | grep "RX packets" | awk '{print $5}')
CURRENT_TX=$(ifconfig $INTERFACE | grep "TX packets" | awk '{print $5}')
sleep 1
NEW_RX=$(ifconfig $INTERFACE | grep "RX packets" | awk '{print $5}')
NEW_TX=$(ifconfig $INTERFACE | grep "TX packets" | awk '{print $5}')

RX_UTIL=$(( ($NEW_RX - $CURRENT_RX) / 1024 ))
TX_UTIL=$(( ($NEW_TX - $CURRENT_TX) / 1024 ))

if [ $RX_UTIL -gt $MAX_UTIL ] || [ $TX_UTIL -gt $MAX_UTIL ]; then
    echo "Alerte: Utilisation √©lev√©e du r√©seau - RX: ${RX_UTIL}KB/s TX: ${TX_UTIL}KB/s" | mail -s "Alerte r√©seau" admin@example.com
fi</code></pre>
fi</code></pre>


<!-- D√©but de la section Gestion des P√©riph√©riques Externes -->
<h2>Gestion des P√©riph√©riques Externes</h2>

<h3>1. Windows (PowerShell) - Imprimantes</h3>
<pre><code># Lister toutes les imprimantes
Get-Printer | Format-Table Name, DriverName, PortName, Shared, Published

# Ajouter une imprimante locale
Add-Printer -Name "HP_LaserJet" -DriverName "HP LaserJet P3015 Series PCL6" -PortName "USB001"

# Ajouter une imprimante r√©seau
Add-Printer -ConnectionName "\\print-server\HP_Color_LaserJet"

# Configurer une imprimante partag√©e
Set-Printer -Name "HP_LaserJet" -Shared $true -ShareName "HP_LaserJet_Shared" -Published $true

# Supprimer une imprimante
Remove-Printer -Name "Old_Printer"

# G√©rer les travaux d'impression
Get-PrintJob -PrinterName "HP_LaserJet" | Where-Object {$_.JobStatus -eq "Error"} | Remove-PrintJob
Restart-PrintJob -PrinterName "HP_LaserJet" -ID 5

# Installer un pilote d'imprimante
pnputil.exe -i -a "C:\Drivers\HP\*.inf"</code></pre>

<h3>2. Windows (PowerShell) - P√©riph√©riques USB et autres</h3>
<pre><code># Lister tous les p√©riph√©riques connect√©s
Get-PnpDevice | Where-Object {$_.Present} | Format-Table FriendlyName, Status, InstanceId

# D√©sactiver un p√©riph√©rique USB
Disable-PnpDevice -InstanceId "USB\VID_0781&PID_5583\AA0123456789" -Confirm:$false

# Activer un p√©riph√©rique
Enable-PnpDevice -InstanceId "USB\VID_0781&PID_5583\AA0123456789" -Confirm:$false

# G√©rer les moniteurs
# (N√©cessite l'installation de DisplaySwitch.exe via Windows SDK)
DisplaySwitch.exe /internal  # Utiliser uniquement l'√©cran int√©gr√©
DisplaySwitch.exe /external  # Utiliser uniquement l'√©cran externe
DisplaySwitch.exe /extend    # √âtendre l'affichage
DisplaySwitch.exe /clone     # Dupliquer l'affichage

# G√©rer les p√©riph√©riques audio
Get-AudioDevice -List | Where-Object {$_.Type -eq "Playback"} | Format-Table Name, ID
Set-AudioDevice -ID "{0.0.0.00000000}.{a12b3c4d-5e67-8f90-1234-567890abcdef}"</code></pre>

<h3>3. Windows (PowerShell) - Scanners</h3>
<pre><code># Lister les scanners disponibles (n√©cessite WIA)
$deviceManager = New-Object -ComObject WIA.DeviceManager
$deviceManager.DeviceInfos | Where-Object {$_.Type -eq 1} | Select-Object Properties

# Scanner un document (script avanc√©)
$device = $deviceManager.DeviceInfos.Item(1).Connect()
$scanner = $device.Items.Item(1)
$image = $scanner.Transfer()
$image.SaveFile("C:\Scans\document_$(Get-Date -Format 'yyyyMMddHHmmss').jpg")</code></pre>

<h3>4. Linux (CLI) - Imprimantes</h3>
<pre><code># Lister les imprimantes
lpstat -p -d

# Installer une imprimante CUPS (Common Unix Printing System)
sudo lpadmin -p HP_LaserJet -E -v socket://192.168.1.10 -m drv:///HP/hp-laserjet.ppd.gz

# D√©finir l'imprimante par d√©faut
sudo lpoptions -d HP_LaserJet

# Soumettre un travail d'impression
lpr -P HP_LaserJet document.pdf

# Annuler un travail d'impression
lprm -P HP_LaserJet 15

# G√©rer les files d'attente
lpq -P HP_LaserJet

# Configurer une imprimante r√©seau Samba
sudo lpadmin -p "Office_Printer" -E -v "smb://user:password@print-server/HP_Color" -m everywhere</code></pre>

<h3>5. Linux (CLI) - P√©riph√©riques USB et autres</h3>
<pre><code># Lister tous les p√©riph√©riques USB
lsusb
lsusb -v  # Version d√©taill√©e

# Identifier un p√©riph√©rique sp√©cifique
udevadm info -a -n /dev/sdb | grep -i "idVendor\|idProduct"

# Monter un p√©riph√©rique USB
sudo mkdir /mnt/usbdrive
sudo mount /dev/sdb1 /mnt/usbdrive -o uid=1000,gid=1000

# D√©montrer un p√©riph√©rique USB
sudo umount /mnt/usbdrive

# G√©rer les moniteurs avec xrandr
xrandr  # Lister les affichages disponibles
xrandr --output HDMI-1 --auto --right-of eDP-1  # Configurer multi-√©crans
xrandr --output HDMI-1 --off  # D√©sactiver un √©cran

# Configurer les p√©riph√©riques audio
pactl list short sinks  # Lister les p√©riph√©riques de sortie
pactl set-default-sink alsa_output.pci-0000_00_1b.0.analog-stereo  # D√©finir la sortie par d√©faut</code></pre>

<h3>6. Linux (CLI) - Scanners</h3>
<pre><code># Installer SANE (Scanner Access Now Easy)
sudo apt install sane sane-utils xsane

# Lister les scanners disponibles
scanimage -L

# Scanner un document (format PNG)
scanimage --format=png --output-file scan.png --resolution 300dpi --mode Color

# Scanner en PDF (n√©cessite imagemagick)
scanimage --format=tiff --resolution 300dpi | convert - scan.pdf

# Configurer un scanner r√©seau
sudo nano /etc/sane.d/net.conf
# Ajouter l'adresse IP du serveur de scanner: 192.168.1.20</code></pre>

<h3>7. Scripts avanc√©s</h3>
<pre><code>#!/bin/bash
# Script Linux de surveillance USB
while true; do
    USB_DEVICES=$(lsusb | wc -l)
    if [ $USB_DEVICES -gt 2 ]; then
        echo "Alerte : Nouveau p√©riph√©rique USB d√©tect√© $(date)" >> /var/log/usb_monitor.log
        lsusb >> /var/log/usb_monitor.log
    fi
    sleep 5
done

<#
# Script PowerShell pour d√©ployer des imprimantes
$Printers = Import-Csv "C:\deploy\printers.csv"
foreach ($printer in $Printers) {
    if ($printer.Type -eq "Network") {
        Add-Printer -ConnectionName $printer.Path
    } else {
        Add-Printer -Name $printer.Name -DriverName $printer.Driver -PortName $printer.Port
    }
    if ($printer.Shared -eq $true) {
        Set-Printer -Name $printer.Name -Shared $true -ShareName $printer.ShareName
    }
}
#></code></pre>

<h3>8. D√©pannage</h3>
<pre><code># Windows - V√©rifier les erreurs de p√©riph√©rique
Get-WinEvent -LogName System | Where-Object {$_.ProviderName -match "USB|Print"} | 
    Select-Object TimeCreated, Message | Format-Table -AutoSize

# Linux - Journal des p√©riph√©riques
sudo journalctl -b | grep -i "usb\|print\|scanner"
sudo dmesg | grep -i "new device"

# R√©initialiser le sous-syst√®me USB (Linux)
echo 0 | sudo tee /sys/bus/usb/devices/usb1/authorized
echo 1 | sudo tee /sys/bus/usb/devices/usb1/authorized

# R√©installer un pilote (Windows)
pnputil.exe /delete-driver oem0.inf /uninstall
pnputil.exe /add-driver "C:\Drivers\new_driver.inf" /install</code></pre>
  </div>

  <script>
    document.querySelectorAll('pre').forEach(pre => {
      const btn = document.createElement('button');
      btn.className = 'copy-btn';
      btn.textContent = 'üìã';
      btn.onclick = () => {
        const code = pre.innerText;
        navigator.clipboard.writeText(code);
        btn.textContent = '‚úÖ';
        setTimeout(() => btn.textContent = 'üìã', 2000);
      };
      pre.appendChild(btn);
    });

    function toggleTheme() {
      const current = document.documentElement.getAttribute('data-theme');
      document.documentElement.setAttribute('data-theme', current === 'dark' ? 'light' : 'dark');
    }
  </script>
</body>
</html>
